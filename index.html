<!doctype html>
<html ng-app="chordOrganApp">
    <head>
        <title>Chord Organ</title>
        <link rel="stylesheet" href="styles.css">
  </head>
  <body ng-controller="chordCtrl">
    <main ng-class="{trenta: !specialChord && !invertChord, venti: invertChord && !specialChord, grande: specialChord && !invertChord, tall: specialChord && invertChord}">
        <div id="instrument" ng-show="!showSettings">
            <div id="modifierMenu">
                <button ng-click="invertMode=!invertMode" ng-class="{on: invertMode}">Mm</button>
                <button ng-click="invertChord=!invertChord" ng-class="{on: invertChord}">x<sup>6</sup></button>
                <button ng-click="specialChord=!specialChord" ng-class="{on: specialChord}" class="special">&#9733;</button>
                <button ng-click="showSettings=!showSettings" class="settings">&#9881;</button>
            </div>
            <div id="chordMenu" ng-mouseup="stop()">
                <button ng-repeat="num in chordNumbers" class="chord{{num}}" ng-mousedown="start(num)">{{label(num)}}</button>
            </div>
        </div>
        <div id="settingsPanel" ng-show="showSettings">
            <button ng-click="showSettings=!showSettings" class="settings">&#9881;</button>
            <select ng-model="keyShift" ng-options="key as key.label for key in keys"></select>
            <ul id="sliders">
            <li>vol<input id="volumeSlider" type="range" min="0" max="1" step=".01" ng-model="synth.maxGain" />{{(synth.maxGain * 100).toFixed(0)}}%</li>
            <li>atk<input id="attackSlider" type="range" min="0" max="5" step="1" ng-model="synth.attack" />{{synth.attack * 1000}}ms</li>
            <li>rel<input id="releaseSlider" type="range" min="0" max="5" step="1" ng-model="synth.release" />{{synth.release * 1000}}ms</li>
            <div id="waveformMenu">
                <button ng-repeat="waveform in waveforms" id="{{waveform}}" ng-click="setWaveform(waveform)" ng-class="{on: selectedWaveform==waveform}"></button>
            </div>
        </div>
    </main>
    <ul>
        <h3>To do:</h3>
        <h4>Settings panel</h4>
        <l1>make volume slider logarithmic</l1>
        <li>add configurable adsr</li>
        <li>add transition (fade in/out)</li>
        <li>change key selector to ul and style a la bootstrap</li>
        <h4>Misc</h4>
        <li>add touchStart=on, touchEnd=off to modifiers & chords</li>
        <li>prevent simultaneous activation of Mm and Special</li>
        <li>port to Phonegap</li>
        <li>MAKE APP STOP HANGING!!!</li>
        <li>fix safari sound distortion</li>
        <li>allow playing music with keystrokes</li>
        <h4>Eventually... (maybe)</h4>
        <li>make settings panel swipe up from bottom</li>
        <li>replace settings button with swipable (to the right) "key slider" to allow quick & easy key changes on the fly</li>
        <li>add option to show chord letters instead of numbers</li>
        <li>add option for minor mode (w/ sharp 7's)</li>
        <li>add support for sample instruments (piano, guitar, etc.)</li>
    </ul>
  </body>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>
  <script src="polysynth.js"></script>
  <script src="chordCtrl.js"></script>
</html>